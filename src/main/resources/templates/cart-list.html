<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>장바구니</title>
  <link rel="stylesheet" th:href="@{/css/main.css}" />
  <link rel="stylesheet" th:href="@{/css/cart.css}" />
  <script defer th:src="@{/js/cart.js}"></script>
</head>
<body>
  <div th:replace="~{fragments/index-header :: header}"></div>

  <section class="cart-container">
    <div class="cart-left">
      <div class="cart-header">
        <h2>장바구니</h2>
        <div class="cart-header-buttons">
          <form id="bulkDeleteForm" th:action="@{/cart/deleteSelected}" method="post">
            <input type="hidden" name="cartItemIds" id="cartItemIdsInput" />
            <button id="deleteSelectedBtn" type="button">선택삭제</button>
          </form>
          <button id="selectAllBtn" type="button">전체선택</button>
        </div>
      </div>

      <form id="checkoutForm" th:action="@{/order}" method="get">
        <input type="hidden" name="cartItemIds" id="selectedCartIds" />

        <div class="cart-item" th:each="item : ${cartItems}">
          <label class="custom-checkbox">
            <input type="checkbox" class="cart-checkbox" name="selectedIds"
                  th:value="${item.id}" th:checked="true" />
            <span class="checkmark"></span>
          </label>

          <img th:src="@{${item.product.imageUrl}}" width="140" height="140" />

          <div class="item-info">
            <div class="item-name" th:text="${item.product.name}">상품명</div>
            <div class="item-cafe" th:text="${item.product.shop.shopName}">디저트 가게명</div>
            <div>수량: <span th:text="${item.quantity}">1</span></div>
          </div>

          <div class="item-price">
            <div th:text="${#numbers.formatInteger(item.product.price * item.quantity, 0)} + '원'"></div>
              <button type="button" class="trash-icon delete-btn" th:data-id="${item.id}">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 32 32">
                <path d="M 15 4 C 14.476563 4 13.941406 4.183594 13.5625 4.5625 C 13.183594 4.941406 13 5.476563 13 6 L 13 7 L 7 7 L 7 9 L 8 9 L 8 25 C 8 26.644531 9.355469 28 11 28 L 23 28 C 24.644531 28 26 26.644531 26 25 L 26 9 L 27 9 L 27 7 L 21 7 L 21 6 C 21 5.476563 20.816406 4.941406 20.4375 4.5625 C 20.058594 4.183594 19.523438 4 19 4 Z M 15 6 L 19 6 L 19 7 L 15 7 Z M 10 9 L 24 9 L 24 25 C 24 25.554688 23.554688 26 23 26 L 11 26 C 10.445313 26 10 25.554688 10 25 Z M 12 12 L 12 23 L 14 23 L 14 12 Z M 16 12 L 16 23 L 18 23 L 18 12 Z M 20 12 L 20 23 L 22 23 L 22 12 Z"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>

            <!-- 오른쪽 영역: 결제 요약 -->
        <div class="cart-summary">
          <label>쿠폰</label>
          <input type="text" disabled />
          <label>포인트</label>
          <input type="text" disabled />

          <div class="total-price-row">
            <span>총 결제 금액:</span>
            <span id="totalPrice" th:text="${#numbers.formatInteger(totalPrice, 0)} + '원'">0원</span>
          </div>

          <button type="submit" class="checkout-btn">결제하기</button>
        </div>
      </form>
  </section>

  <script th:src="@{/js/main.js}" defer></script>
  <script th:src="@{/js/header.js}" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>
